---
title: Syntaxe 
sidebar_position: 3
---

import { CL} from "@site/src/components/utils.tsx";

## Symboles et expressions

- **<mark>`$`</mark>** :
  - <CL>Usage</CL> : Symbolise la valeur de la statistique utilisée dans la formule du dé.
  - <CL>Où ?</CL> Utilisé dans les dés types (`/dbroll`, `/calc`, formules critiques, etc.)  
    :::example  
      - `1d6 > $` : Compare le résultat du dé à la valeur de la statistique sélectionnée.  
      - `1d6 + $` : Ajoute la statistique au résultat du dé.  
      - `1d100 <=$` : Pour les systèmes type Appel de Cthulhu, compare au seuil de la stat.
    :::

- **<mark>`{exp}`</mark>** :
  - <CL>Usage :</CL> Permet d'insérer une expression dynamique dans une formule de dé, reprise d'une partie calculée de la commande.
  - <CL>Syntaxe avancée :</CL> `{exp||default}` permet de définir une valeur par défaut si l'expression n'est pas renseignée.
    :::example `{exp||2}` (valeur par défaut = 2)
    :::
  - <CL>Où ?</CL> Souvent utilisé dans des templates ou des formules réutilisables, pour injecter une valeur dynamique au moment du jet.  
    :::example
      - `1d6 > {exp}` : la valeur de `exp` sera remplacée au moment du lancer.  
      - `1d6 > {exp||10}` : si `exp` n'est pas renseignée, la comparaison se fait à 10.
    :::

- **<mark>`{{...}}`</mark>** :
  - <CL>Usage :</CL> Délimite une expression mathématique complexe évaluée par <mark>MathJS</mark>.
  - <CL>Où ?</CL> Dans toutes les commandes supportant les formules (`/calc`, `/dbroll`, `/macro`, etc.)
    :::example  
      - `1d6 + {{ceil($ / 2)}}` : Ajoute la moitié arrondie de la stat au résultat du dé.  
      - `1d6 > {{ceil($ / 2)}}` : Le seuil de réussite est la moitié de la stat, arrondie.
    :::

- **<mark>`[commentaire]`</mark>** :
  - <CL>Usage :</CL> Ajoute un commentaire à un dé.
  - <CL>Où ?</CL> Dans des [dés partagés](./expression.mdx#jets-uniques-partagés-réutilisation-de-résultats). 
    :::example `1d20;&-2[Perte de PV]` : Applique -2 au résultat du jet de dé et annote la seconde ligne de résultat.
    :::

- **<mark>`#commentaire`</mark>** :
  - <CL>Usage :</CL> Commentaire global pour un jet de dés. Le `#` symbole peut être omit lors de l'utilisation sur des messages directs.
  - <CL>Où ?</CL> À la fin du dé, pour annoter l'action. Permet aussi de créer un commentaire global dans les dés partagés. 
    Non utilisés pour les dés par slashcommand.
    :::example
    - `1d20+5 # Mon jet de dés`
    - `1d20;&+5;&*2 # Mon jet de dés partagé`
    :::

- **<mark>`&`</mark>**, **<mark>`;&+x;`</mark>**, **etc.**  :
  - <CL>Usage :</CL> Permet de réutiliser le résultat d'un même dé dans plusieurs formules (jets uniques partagés).
    :::example
    ```
    /roll 1d20;&+5;&*2
    ```
    Affichera :
    ```
    ※ 1d20 ⟶ [14] =  14 
    ◈ [1d20]+5 ⟶ [14]+5 =  19 
    ◈ [1d20]×2 ⟶ [14]×2 =  28 
    ```
    :::
- **<mark>`()`</mark> (parenthèses dans les noms de dé)** :
  - <CL>Usage :</CL> Spécifie la statistique à utiliser pour les critiques personnalisés
    :::example[ `Instinct Animal (Force)` ]
    :::

---
:::example
- **Dé type :**  
  - `1d6 > $` ou `1d6 + $`  
  - `1d6 + {{ceil($/2)}}`
- **Macro :**
  - `1d6 > Force` ou `1d6 + Force`  
  - `1d6 + {{ceil(Force / 2)}}`
- **Critique personnalisé :**  
  - Nom : `Instinct Animal (Force)`  
  - Formule : `>$` (`$` sera remplacé par la valeur de Force)
  - Résultat : `1d6>10` (si `Force = 10`)
:::
---
## Syntaxe des commandes
- Les champs obligatoires sont indiqués entre crochets : <mark class='green'>`[champs]`</mark>.
- Les champs facultatifs sont entre parenthèses : <mark class='green'>`(champs)`</mark>.
- Les champs auto-complétés seront marqués d'un <mark>`*`</mark> : <mark class='green'>`(*champs)`</mark>.
- Les champs demandant une mention seront marqués par <mark>`@`</mark> (<mark class='green'>`@champs`</mark>). Ces champs fonctionnent avec les noms (rôle ou utilisateur, en fonction de la commande) ou l'<mark>ID Discord</mark>. Si la mention ne s'affiche pas immédiatement, commencez à taper le début du nom pour l'auto-complétion.
- De manière similaire, les commandes demandant un salon sont précédé par <mark>`#`</mark> comme <mark class='green'>`#champs`</mark>.
- Les champs vrai/faux (`true` ou `false`) sont préfixés par <mark>`?`</mark> <mark class='green'>(`?champs`)</mark>.

### Commandes auto-complétées

Dans plusieurs commandes, il est possible de combiner à la fois un nom d'utilisateur et un personnage.

Par défaut, les personnages affichés dans la liste sont ceux de l'utilisateur qui a tapé la commande.

Si vous souhaitez afficher les personnages d'un autre joueur, vous devez mentionner le joueur en premier.

:::warning
À cause de certaines limitations de l'API Discord, si vous souhaitez changer de joueur, vous devez retaper la commande en entier.
:::
